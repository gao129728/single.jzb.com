{include file="public/header" /}
<body class="gray-bg">
<style type="text/css">
    .radio{position:relative; display: inline-block; padding-right:20px;}
    .radio .group_item{float:left; white-space: nowrap; padding-right:30px;}
    .member_group .help-question{margin-top:-8px;}
</style>
<div class="wrapper wrapper-content animated fadeInRight">
    <div class="row">
        <div class="col-sm-12">
            <div class="ibox float-e-margins">
                <div class="ibox-title">
                    <h5>网站配置</h5>
                </div>
                <div class="ibox-content">       
                    <div class="panel blank-panel">
                        <div class="panel-options">
                            <ul class="nav nav-tabs">
                                <li class="active"><a data-toggle="tab" href="#tab-1" aria-expanded="true">基本设置</a></li>
                                <li class=""><a data-toggle="tab" href="#tab-2" aria-expanded="false">高级设置</a></li>
                            </ul>
                        </div>
                        <form action="{:url('save')}" method="post" class="form-horizontal" id="config">
                            <div class="tab-content">
                                <div id="tab-1" class="tab-pane active">
                                    <div class="form-group">
                                        <label class="col-sm-2 control-label">网站Logo：</label>
                                        <div class="col-sm-2" style="padding:0;">
                                            <div class="uploadImg-box">
                                                <input type="file" name="web_site_logo" id="web_site_logo" class="imgFile" onchange="previewImage(this)"/>
                                                <div class="up-img {if $config.web_site_logo neq ''}hidden-box{/if}"><i class="fa fa-cloud-upload"></i><p>点击上传图片</p></div>
                                                {if $config.web_site_logo neq ''}
                                                <input type="checkbox" name="delLogo" class="input-del" value="1" />
                                                <div class="imgView"><img src="__UPLOAD_PATH__/{$config.web_site_logo}"/></div>
                                                {/if}
                                                <div class="uploadCover">
                                                    <div class="ulinfo clearfix">
                                                        <span class="up-btn"><i class="fa fa-cloud-upload"></i></span>
                                                        <span class="up-del"><i class="fa fa-close"></i></span>
                                                    </div>
                                                </div>
                                            </div>
                                            <p class="tips-text">仅支持jpg、png、gif</p>
                                        </div>
                                        <label class="col-sm-1 control-label">二维码：</label>
                                        <div class="col-sm-2" style="padding:0;">
                                            <div class="uploadImg-box">
                                                <input type="file" name="web_site_qrcode" id="web_site_qrcode" class="imgFile" onchange="previewImage(this)"/>
                                                <div class="up-img {if $config.web_site_qrcode neq ''}hidden-box{/if}"><i class="fa fa-cloud-upload"></i><p>点击上传图片</p></div>
                                                {if $config.web_site_qrcode neq ''}
                                                <input type="checkbox" name="delQrcode" class="input-del" value="1" />
                                                <div class="imgView"><img src="__UPLOAD_PATH__/{$config.web_site_qrcode}"/></div>
                                                {/if}
                                                <div class="uploadCover">
                                                    <div class="ulinfo clearfix">
                                                        <span class="up-btn"><i class="fa fa-cloud-upload"></i></span>
                                                        <span class="up-del"><i class="fa fa-close"></i></span>
                                                    </div>
                                                </div>
                                            </div>
                                            <p class="tips-text">仅支持jpg、png、gif，推荐尺寸：100*100px</p>
                                        </div>
                                        <label class="col-sm-1 control-label">网站Ico：</label>
                                        <div class="col-sm-2" style="padding:0;">
                                            <div class="uploadImg-box sm-uploadImg">
                                                <input type="file" name="web_site_ico" id="web_site_ico" class="imgFile" onchange="previewImage(this,'ico')"/>
                                                <div class="up-img {if $config.web_site_ico neq ''}hidden-box{/if}"><i class="fa fa-cloud-upload"></i><p>上传ico</p></div>
                                                {if $config.web_site_ico neq ''}
                                                <input type="checkbox" name="delIco" class="input-del" value="1" />
                                                <div class="imgView"><img src="__UPLOAD_PATH__/{$config.web_site_ico}"/></div>
                                                {/if}
                                                <div class="uploadCover">
                                                    <div class="ulinfo clearfix">
                                                        <span class="up-btn"><i class="fa fa-cloud-upload"></i></span>
                                                        <span class="up-del"><i class="fa fa-close"></i></span>
                                                    </div>
                                                </div>
                                            </div>
                                            <p class="tips-text">仅支持ico，<a href="http://www.bitbug.net" target="_blank">推荐格式在线转换地址</a></p>
                                        </div>
                                    </div>
                                    <div class="hr-line-dashed"></div>
                                    <div class="form-group">
                                        <label class="col-sm-2 control-label">网站名称：</label>
                                        <div class="input-group col-sm-4">
                                            <input type="text" class="form-control" id="web_site_name" name="config[web_site_name]" value="{$config.web_site_name}">
                                        </div>
                                    </div>
                                    <div class="hr-line-dashed"></div>
                                    <div class="form-group">
                                        <label class="col-sm-2 control-label">网站标题：</label>
                                        <div class="input-group col-sm-4">
                                            <input type="text" class="form-control" id="web_site_title" name="config[web_site_title]" value="{$config.web_site_title}">
                                            <span class="help-question"><a data-toggle="tooltip" data-placement="auto right" title="网站首页SEO标题"><i class="fa fa-question-circle-o"></i></a></span>
                                        </div>
                                    </div>
                                    <div class="hr-line-dashed"></div>
                                    <div class="form-group">
                                        <label class="col-sm-2 control-label">网站关键字：</label>
                                        <div class="input-group col-sm-4">
                                            <input type="text" class="form-control" name="config[web_site_keyword]" value="{$config.web_site_keyword}">
                                            <span class="help-question"><a data-toggle="tooltip" data-placement="auto right" title="网站SEO关键字"><i class="fa fa-question-circle-o"></i></a></span>
                                        </div>
                                    </div>
                                    <div class="hr-line-dashed"></div>
                                    <div class="form-group">
                                        <label class="col-sm-2 control-label">网站描述：</label>
                                        <div class="input-group col-sm-4">
                                            <textarea class="form-control" type="text" rows="3" name="config[web_site_description]">{$config.web_site_description}</textarea>
                                            <span class="help-question"><a data-toggle="tooltip" data-placement="auto right" title="网站SEO描述"><i class="fa fa-question-circle-o"></i></a></span>
                                        </div>
                                    </div>
                                    <div class="hr-line-dashed"></div>
                                    <div class="form-group">
                                        <label class="col-sm-2 control-label">服务热线：</label>
                                        <div class="input-group col-sm-4">
                                            <input type="text" class="form-control input_wd2" name="config[web_service_line]" value="{$config.web_service_line}">
                                        </div>
                                    </div>
                                    <div class="hr-line-dashed"></div>
                                    <div class="form-group">
                                        <label class="col-sm-2 control-label">网站备案号：</label>
                                        <div class="input-group col-sm-4">
                                            <input type="text" class="form-control" name="config[web_site_icp]" value="{$config.web_site_icp}">
                                        </div>
                                    </div>
                                    <div class="hr-line-dashed"></div>
                                    <div class="form-group">
                                        <label class="col-sm-2 control-label">联系我们：</label>
                                        <div class="input-group col-sm-6">
                                            <script src="/static/admin/ueditor/ueditor.config.js" type="text/javascript"></script>
                                            <script src="/static/admin/ueditor/ueditor.all.js" type="text/javascript"></script>
                                            <textarea name="config[web_site_contact]" id="myEditor1" style="width:100%">{$config.web_site_contact}</textarea>
                                            <script type="text/javascript">
                                                var editor1 = UE.getEditor('myEditor1', {
                                                    toolbars: [
                                                        ['fullscreen', 'source', 'undo', 'redo', 'bold', 'italic', 'underline', 'fontborder', 'strikethrough', 'superscript', 'subscript', 'removeformat', 'formatmatch', 'autotypeset', 'blockquote', 'pasteplain', '|', 'forecolor', 'backcolor', 'insertorderedlist', 'insertunorderedlist', 'selectall', 'cleardoc','fontfamily','fontsize','lineheight','justifyleft','justifycenter','justifyright','justifyjustify', '|','link','unlink']
                                                    ],
                                                    autoHeightEnabled: true,
                                                    autoFloatEnabled: true,
                                                    initialFrameHeight:200
                                                });
                                            </script>
                                            <span class="help-question"><a data-toggle="tooltip" data-placement="auto right" title="网站底部联系信息"><i class="fa fa-question-circle-o"></i></a></span>
                                        </div>
                                    </div>
                                    <div class="hr-line-dashed"></div>
                                    <div class="form-group">
                                        <label class="col-sm-2 control-label">版权信息：</label>
                                        <div class="input-group col-sm-6">
                                            <textarea name="config[web_site_copy]" id="myEditor2" style="width:100%">{$config.web_site_copy}</textarea>
                                            <script type="text/javascript">
                                                var editor1 = UE.getEditor('myEditor2', {
                                                    toolbars: [
                                                        ['fullscreen', 'source', 'undo', 'redo', 'bold', 'italic', 'underline', 'fontborder', 'strikethrough', 'superscript', 'subscript', 'removeformat', 'formatmatch', 'autotypeset', 'blockquote', 'pasteplain', '|', 'forecolor', 'backcolor', 'insertorderedlist', 'insertunorderedlist', 'selectall', 'cleardoc','fontfamily','fontsize','lineheight','justifyleft','justifycenter','justifyright','justifyjustify', '|','link','unlink']
                                                    ],
                                                    autoHeightEnabled: true,
                                                    autoFloatEnabled: true,
                                                    initialFrameHeight:200
                                                });
                                            </script>
                                            <span class="help-question"><a data-toggle="tooltip" data-placement="auto right" title="设置在网站底部显示的版权信息"><i class="fa fa-question-circle-o"></i></a></span>
                                        </div>
                                    </div>
                                </div>
                                <div id="tab-2" class="tab-pane">
                                    <div class="form-group">
                                        <label class="col-sm-2 control-label">网站风格：</label>
                                        <div class="col-sm-8 input-group">
                                            <input type="hidden" id="web_site_style" name="config[web_site_style]" value="{$config.web_site_style}"/>
                                            <div class="web-style-option clearfix">
                                                <span class="theme color1 {if $config.web_site_style eq 1}active{/if}" data-value="1"></span>
                                                <span class="theme color2 {if $config.web_site_style eq 2}active{/if}" data-value="2"></span>
                                                <span class="theme color3 {if $config.web_site_style eq 3}active{/if}" data-value="3"></span>
                                                <span class="theme color4 {if $config.web_site_style eq 4}active{/if}" data-value="4"></span>
                                                <span class="theme color5 {if $config.web_site_style eq 5}active{/if}" data-value="5"></span>
                                                <span class="theme color6 {if $config.web_site_style eq 6}active{/if}" data-value="6"></span>
                                                <span class="theme color7 {if $config.web_site_style eq 7}active{/if}" data-value="7"></span>
                                                <span class="theme color8 {if $config.web_site_style eq 8}active{/if}" data-value="8"></span>
                                                <span class="theme color9 {if $config.web_site_style eq 9}active{/if}" data-value="9"></span>
                                                <span class="theme color10 {if $config.web_site_style eq 10}active{/if}" data-value="10"></span>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="hr-line-dashed"></div>
                                    <div class="form-group">
                                        <label class="col-sm-2 control-label">导航样式：</label>
                                        <div class="col-sm-10 input-group">
                                            <div class="radio i-checks clearfix">
                                                <span class="group_item"><input type="radio" name='config[web_nav_style]' value="1" {if $config.web_nav_style eq 1}checked{/if}/>导航样式1</span>
                                                <span class="group_item"><input type="radio" name='config[web_nav_style]' value="2" {if $config.web_nav_style eq 2}checked{/if}/>导航样式2</span>
                                                <span class="group_item"><input type="radio" name='config[web_nav_style]' value="3" {if $config.web_nav_style eq 3}checked{/if}/>导航样式3</span>
                                                <span class="group_item"><input type="radio" name='config[web_nav_style]' value="4" {if $config.web_nav_style eq 4}checked{/if}/>导航样式4</span>
                                                <span class="group_item"><input type="radio" name='config[web_nav_style]' value="5" {if $config.web_nav_style eq 5}checked{/if}/>导航样式5</span>
                                                <span class="group_item"><input type="radio" name='config[web_nav_style]' value="6" {if $config.web_nav_style eq 6}checked{/if}/>导航样式6</span>
                                                <span class="group_item"><input type="radio" name='config[web_nav_style]' value="7" {if $config.web_nav_style eq 7}checked{/if}/>导航样式7</span>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="hr-line-dashed"></div>
                                    <div class="form-group">
                                        <label class="col-sm-2 control-label">显示导航下拉：</label>
                                        <div class="col-sm-6 input-group">
                                            <input type="checkbox" name="config[web_subnav]" value="1" class="lcs_check" lcs-text="是|否" autocomplete="off" {if $config.web_subnav eq 1}checked{/if}/>
                                        </div>
                                    </div>
                                    <div class="hr-line-dashed"></div>
                                    <div class="form-group">
                                        <label class="col-sm-2 control-label">网站屏蔽右键：</label>
                                        <div class="col-sm-6 input-group">
                                            <input type="checkbox" name="config[web_rightbutton]" value="1" class="lcs_check" lcs-text="是|否" autocomplete="off" {if $config.web_rightbutton eq 1}checked{/if}/>
                                        </div>
                                    </div>
                                    <div class="hr-line-dashed"></div>
                                    <div class="form-group">
                                        <label class="col-sm-2 control-label">网站搜索：</label>
                                        <div class="col-sm-6 input-group">
                                            <input type="checkbox" name="config[web_site_search]" value="1" class="lcs_check" lcs-text="开启|关闭" autocomplete="off" {if $config.web_site_search eq 1}checked{/if}/>
                                        </div>
                                    </div>
                                    <div class="hr-line-dashed"></div>
                                    <div class="form-group">
                                        <label class="col-sm-2 control-label">网站会员功能：</label>
                                        <div class="col-sm-6 input-group site_member">
                                            <input type="checkbox" name="config[web_site_member]" value="1" class="lcs_check" lcs-text="开启|关闭" autocomplete="off" {if $config.web_site_member eq 1}checked{/if}/>
                                        </div>
                                    </div>
                                    {if $member_group}
                                    <div class="member_group {if $config.web_site_member neq 1}hidden-box{/if}">
                                        <div class="hr-line-dashed"></div>
                                        <div class="form-group">
                                            <label class="col-sm-2 control-label">开启会员注册：</label>
                                            <div class="col-sm-6 input-group">
                                                <input type="checkbox" name="config[web_member_reg]" value="1" class="lcs_check" lcs-text="是|否" autocomplete="off" {if $config.web_member_reg eq 1}checked{/if}/>
                                            </div>
                                        </div>
                                        <div class="hr-line-dashed"></div>
                                        <div class="form-group">
                                            <label class="col-sm-2 control-label">默认会员等级：</label>
                                            <div class="col-sm-10 input-group">
                                                <div class="radio i-checks clearfix">
                                                    {volist name="member_group" id="vo"}
                                                    <span class="group_item"><input type="radio" name='config[web_member_group]' value="{$vo.id}" {if $config.web_member_group eq $vo.id}checked{/if}/>{$vo.group_name}</span>
                                                    {/volist}
                                                    <span class="help-question"><a data-toggle="tooltip" data-placement="auto right" title="会员注册时默认的会员等级"><i class="fa fa-question-circle-o"></i></a></span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    {/if}
                                    <div class="hr-line-dashed"></div>
                                    <div class="form-group">
                                        <label class="col-sm-2 control-label">头部Javascript代码：</label>
                                        <div class="input-group col-sm-4">
                                            <textarea class="form-control" type="text" rows="3" name="config[web_head_javascript]">{$config.web_head_javascript}</textarea>
                                            <span class="help-question"><a data-toggle="tooltip" data-placement="auto right" title="加在页面头部head标签中，请确保代码的安全性"><i class="fa fa-question-circle-o"></i></a></span>
                                        </div>
                                    </div>
                                    <div class="hr-line-dashed"></div>
                                    <div class="form-group">
                                        <label class="col-sm-2 control-label">底部Javascript代码：</label>
                                        <div class="input-group col-sm-4">
                                            <textarea class="form-control" type="text" rows="3" name="config[web_footer_javascript]">{$config.web_footer_javascript}</textarea>
                                            <span class="help-question"><a data-toggle="tooltip" data-placement="auto right" title="加在页面底部，请确保代码的安全性"><i class="fa fa-question-circle-o"></i></a></span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="hr-line-dashed"></div>
                            <div class="form-group">
                                <div class="col-sm-4 col-sm-offset-2 button-group">
                                    <button class="btn btn-warning" type="submit"><i class="fa fa-save"></i> 保存信息</button>&nbsp;&nbsp;&nbsp;
                                </div>
                            </div>
                        </form>
                    </div>         
                </div>
            </div>
        </div>
    </div>
</div>
{include file="public/footer" /}
<script type="text/javascript">
    $(".web-style-option .theme").click(function(){
        var val = $(this).attr('data-value');
        $(this).addClass('active').siblings().removeClass('active');
        $('#web_site_style').val(val);
    });

    $('.site_member').delegate('.lcs_check', 'lcs-statuschange', function() {
        var status = $(this).is(':checked');
        if(status){
            $('.member_group').show();
        }else{
            $('.member_group').hide();
        }
    });

    $(function(){
        $('#config').ajaxForm({
            beforeSubmit: checkForm, // 此方法主要是提交前执行的方法，根据需要设置
            success: complete, // 这是提交后的方法
            dataType: 'json'
        });

        function checkForm(){
            if($('#web_site_name').val() == ''){
                layer.msg('请输入网站名称！', {icon: 5,time:1500,shade: 0.1}, function(index){
                    layer.close(index);
                });
                return false;
            }
            if($('#web_site_title').val() == ''){
                layer.msg('请输入网站标题！', {icon: 5,time:1500,shade: 0.1}, function(index){
                    layer.close(index);
                });
                return false;
            }
            if($('#web_site_logo').val() != ''){
                var ext = $('#web_site_logo').val().substr($('#web_site_logo').val().length - 3).toLowerCase();
                if (ext != "gif" && ext != "jpg" && ext != "png")
                {
                    layer.msg('图片必须是GIF、JPG或PNG格式！', {icon: 5,time:1500,shade: 0.1}, function(index){
                        layer.close(index);
                    });
                    return false;
                }
            }
            if($('#web_site_qrcode').val() != ''){
                var ext = $('#web_site_qrcode').val().substr($('#web_site_qrcode').val().length - 3).toLowerCase();
                if (ext != "gif" && ext != "jpg" && ext != "png")
                {
                    layer.msg('图片必须是GIF、JPG或PNG格式！', {icon: 5,time:1500,shade: 0.1}, function(index){
                        layer.close(index);
                    });
                    return false;
                }
            }
        }

        function complete(data){
            if(data.code == 1){
                layer.msg(data.msg, {icon: 6,time:1500,shade: 0.1}, function(index){
                    layer.close(index);
                    location.reload();
                });
            }else{
                layer.msg(data.msg, {icon: 5,time:1500,shade: 0.1}, function(index){
                    layer.close(index);
                });
                return false;
            }
        }
    });
</script>
</body>
</html>
